<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=600">
    <meta name="generator" content="Hugo 0.29" />
    <title>Jekyll の記事と WordPress の記事を Hugo にインポートする | 5000164 is here</title>
    <link href="/favicon.ico" rel="icon">
    <link href="https://fonts.googleapis.com/earlyaccess/sawarabimincho.css" rel="stylesheet">
    <link href="/css/main.css" rel="stylesheet">
    <link href="/css/monokai.css" rel="stylesheet">
    <link href="http://blog.5000164.jp/2017-08-import/" rel="canonical">
</head>
<body>
<header>
    <a href="http://blog.5000164.jp">5000164 is here</a>
</header>

<article>
    <div>2017-08-13</div>
    <h1>Jekyll の記事と WordPress の記事を Hugo にインポートする</h1>
    

<h2 id="背景">背景</h2>

<p>WordPress から Jekyll に移行した時に記事の移行が面倒で放っておいた。<br />
Hugo に移行することにしたから Jekyll の記事と WordPress の記事を Hugo にインポートすることになった。<br />
つらい。</p>

<h2 id="hugo-に合わせた最終的な形式">Hugo に合わせた最終的な形式</h2>

<p>こんな感じに統一することを目指す。<br />
記事のファイルの見通しをよくするためにディレクトリを分けて管理したかったので URL は各ファイルで指定する。</p>
<div class="highlight"><pre class="chroma"><code class="language-md" data-lang="md"><span class="ln">1</span><span class="s1f40">+++</span><span class="ss4">
</span><span class="ln">2</span><span class="ss4"></span><span class="s1f40">title = &#34;Jekyll の記事と WordPress の記事を Hugo にインポートする&#34;</span><span class="ss4">
</span><span class="ln">3</span><span class="ss4"></span><span class="s1f40">date = 2017-08-13T04:26:50+09:00</span><span class="ss4">
</span><span class="ln">4</span><span class="ss4"></span><span class="s1f40">url = &#34;2017-08-import&#34;</span><span class="ss4">
</span><span class="ln">5</span><span class="ss4"></span><span class="s1f40">+++</span><span class="ss4">
</span><span class="ln">6</span><span class="ss4">
</span><span class="ln">7</span><span class="ss4"></span><span class="s1b61">##</span><span class="s1f40"> 記事内容
</span><span class="ln">8</span><span class="s1f40"></span><span class="ss4">
</span><span class="ln">9</span><span class="ss4"></span><span class="s1f40">つらつら</span></code></pre>
</div>
<h2 id="手順">手順</h2>

<p>実際に行ったインポート作業の内容はこちら。<br />
<a href="https://github.com/5000164/blog/pull/2">Feature import article by 5000164 · Pull Request #2 · 5000164/blog</a></p>

<h3 id="wordpress-の記事を-markdown-形式に変換する">WordPress の記事を Markdown 形式に変換する</h3>

<p>最初は Jekyll に移行しようと思ってたのでこれを使いました。<br />
<a href="https://github.com/benbalter/wordpress-to-jekyll-exporter">benbalter/wordpress-to-jekyll-exporter: One-click WordPress plugin that converts all posts, pages, taxonomies, metadata, and settings to Markdown and YAML which can be dropped into Jekyll</a></p>

<h3 id="ファイル名を調整する">ファイル名を調整する</h3>

<p>なんか日付がたくさんついてたので年と月でディレクトリを分けてからファイル名をきれいにした。</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span><span class="s1f40">brew install rename
</span><span class="ln">2</span><span class="s1f40">find . -name </span><span class="sc1c">&#34;*.md&#34;</span><span class="s1f40"> </span><span class="s1388">|</span><span class="s1f40"> xargs rename </span><span class="sc1c">&#39;s/\d\d\d\d-\d\d-\d\d-\d\d\d\d-\d\d-//&#39;</span></code></pre>
</div>
<h3 id="jekyll-の記事の-url-はファイル名に依存してたのでファイルの中に書き込む">Jekyll の記事の URL はファイル名に依存してたのでファイルの中に書き込む</h3>

<p>ファイル名をファイルの中に書き込んでからあとで url に設定をするようにする。<br />
ついでにファイル名も調整する。</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="ln">1</span><span class="s3e8">for</span><span class="s1f40"> i in </span><span class="s3e8">$(</span><span class="s1f40">find . -name </span><span class="sc1c">&#34;*.markdown&#34;</span><span class="s3e8">)</span><span class="s1388">;</span><span class="s1f40"> </span><span class="s3e8">do</span><span class="s1f40"> </span><span class="s7d0">echo</span><span class="s1f40"> </span><span class="sc1c">${</span><span class="s7d0">i</span><span class="sc1c">}</span><span class="s1f40"> &gt; </span><span class="sc1c">${</span><span class="s7d0">i</span><span class="sc1c">}</span><span class="s1f40">.new</span><span class="s1388">;</span><span class="s1f40"> cat </span><span class="sc1c">${</span><span class="s7d0">i</span><span class="sc1c">}</span><span class="s1f40"> &gt;&gt; </span><span class="sc1c">${</span><span class="s7d0">i</span><span class="sc1c">}</span><span class="s1f40">.new</span><span class="s1388">;</span><span class="s1f40"> </span><span class="s3e8">done</span><span class="s1f40">
</span><span class="ln">2</span><span class="s1f40">find . -name </span><span class="sc1c">&#34;*.markdown.new&#34;</span><span class="s1f40"> </span><span class="s1388">|</span><span class="s1f40"> xargs rename </span><span class="sc1c">&#39;s/.markdown.new/.md/&#39;</span><span class="s1f40">
</span><span class="ln">3</span><span class="s1f40">find . -name </span><span class="sc1c">&#34;*.markdown&#34;</span><span class="s1f40"> </span><span class="s1388">|</span><span class="s1f40"> xargs rm -f
</span><span class="ln">4</span><span class="s1f40">find . -name </span><span class="sc1c">&#34;*.md&#34;</span><span class="s1f40"> </span><span class="s1388">|</span><span class="s1f40"> xargs rename </span><span class="sc1c">&#39;s/\d\d\d\d-\d\d-\d\d-//&#39;</span></code></pre>
</div>
<h3 id="ひたすら正規表現で置換する">ひたすら正規表現で置換する</h3>

<p>あとはもう望む形になるようにひたすら正規表現で置換する。<br />
<code>title</code> と <code>date</code> は最初から入っているものをうまく使う。<br />
Jekyll の <code>date</code> の形式が違くてエラーになっていたので書式に気をつける。<br />
WordPress からエクスポートした記事には <code>permalink</code> が入っていたのでそれをうまく利用して <code>url</code> にする。<br />
Jekyll のファイルには先ほどファイルの中に埋め込んだファイル名をうまく使って <code>url</code> にする。<br />
画像のリンクとかもひたすら変換する。</p>

<h3 id="あとはなんかおかしいのを見つけたら手で直す">あとはなんかおかしいのを見つけたら手で直す</h3>

<p>WordPress からエクスポートしたものが変なふうになってたり、なぜか <code>date</code> が 2 個設定されている記事があったり、おかしいものがあったら見つけ次第手で直す。</p>

<h2 id="見た目おかしかったり壊れてるところがあったりするけどひとまず完了">見た目おかしかったり壊れてるところがあったりするけどひとまず完了</h2>

<p>なんとなく見られるようになればよい、という感じでやりました。</p>

</article>
<footer>
    SUGAWARA Hiroshi
</footer>


<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-51024599-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>


</body>
</html>

